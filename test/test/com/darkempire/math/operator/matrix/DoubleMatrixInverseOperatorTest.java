package test.com.darkempire.math.operator.matrix;

import com.darkempire.math.operator.matrix.InverseMethodType;
import com.darkempire.math.operator.matrix.PseudoInverseMethodType;
import com.darkempire.math.struct.matrix.DoubleFixedMatrix;
import com.darkempire.math.struct.matrix.DoubleMatrix;
import junit.framework.Assert;
import org.junit.Test;

import static com.darkempire.math.operator.matrix.DoubleMatrixInverseOperator.inverse;
import static com.darkempire.math.operator.matrix.DoubleMatrixInverseOperator.pseudoInverse;
import static org.hamcrest.MatcherAssert.assertThat;
import static test.util.DoubleMatrixMatcher.equalsEps;

/**
 * Created by siredvin on 23.10.14.
 *
 * @author siredvin
 */
public class DoubleMatrixInverseOperatorTest extends Assert {

    @Test
    public void testPseudoInverseGreville() {
        DoubleMatrix a, atest;
        a = DoubleFixedMatrix.createInstance(8, 9, new double[]{0.3471137752452498, 0.04928290587194728, 0.2861960175837567, 0.11645828436896866, 0.13998887539984728, 0.29876876781315864, 0.15836255043633507, 0.595995437318177, 0.07096663914247758, 0.5688961761470526, 0.7330570510681094, 0.7088143416826275, 0.7448966216263518, 0.6604889502046354, 0.8383101115714544, 0.4802020658955115, 0.33226301996514673, 0.33655493236262424, 0.8154029664206408, 0.984984144157132, 0.8327678885538514, 0.891801838294358, 0.680349893086467, 0.2528383676232995, 0.3458339781083505, 0.8573348885853801, 0.6476557947194818, 0.02956614736578267, 0.7266917803544971, 0.8375636187745642, 0.17978244485221861, 0.6409127356510804, 0.45020063053155057, 0.20987444814113831, 0.20555911661528348, 0.7653353628528838, 0.9160872185019945, 0.19740370110902583, 0.5021423418984897, 0.27503655726943976, 0.6326941047872703, 0.4921342765654333, 0.9867396776554209, 0.7204036313526223, 0.6606549127020535, 0.26375019521151755, 0.7830027688666609, 0.6030450879668138, 0.23869880704329116, 0.7187030179302787, 0.13729372325546674, 0.16556104263874527, 0.3546157248261037, 0.31259578275194266, 0.6636223820189321, 0.5786211237129865, 0.24281254743778047, 0.9367642105286647, 0.24966848174362244, 0.03864447509786462, 0.1959623698125399, 0.587471434887976, 0.7755126335023235, 0.1625305446337575, 0.6636378617521836, 0.0813818200784765, 0.3582396804183361, 0.39058114364818897, 0.5683612248669992, 0.4279113100243578, 0.5623594327415111, 0.1842114982206946});
        atest = DoubleFixedMatrix.createInstance(9, 8, new double[]{0.5651248129845285, 0.656931969814907, -1.0158033999395344, -0.8995837123363661, 0.29728053677880595, 1.3038203704580624, 0.7646517269577205, -0.9313268105410196, -1.6723993898266338, -0.6580196077227309, 2.227049310889921, 0.11984258692028799, -0.1534178309411659, -1.0800913637563552, -1.2911371427920577, 1.087341185325378, -0.741848212549783, -0.2656940184906117, 3.354720000490959, 0.8359897761426531, -0.03310206023488216, -2.486607965700329, -2.266342196997149, -0.5410593187789258, -0.37119347458669577, 0.6765836795734356, 0.28339145178817304, -0.2963053877609101, -0.35492598097545175, -0.5578887266646835, 0.4136904138223644, -0.10734115749658762, 1.8543107193763981, 1.0289404962465845, -4.800504114909982, -0.9662453923437602, 0.0486964982575252, 4.828260873314706, 2.608758649647998, -0.8475339273385897, 1.5586720160411456, 1.1262872692908403, -2.18064825930433, 0.2591941350219291, -0.36264575116770426, 0.5287825446915624, 0.9803770087981467, 0.08656891456454763, -3.0266857151042075, -0.9188036441499315, 3.8564116812676734, 0.2650503907361018, 1.0569729980620135, -3.1882375483980088, -2.6614310176121285, 1.1389855048059228, 1.451237730789479, -0.8579797871228971, 0.127954557745763, 0.08471851732612831, -0.20862301110589498, 0.040971530536602324, 0.09041875841708702, 0.6097112160960524, 0.4356676229754963, -0.3105371518845968, -1.6023254379482568, 0.9435499368094239, 0.19251489318009216, 0.3364419748817017, 1.5236580896247283, -0.19639788238840913});
        assertThat(pseudoInverse(a, PseudoInverseMethodType.GREVILLE_METHOD), equalsEps(atest, 1.0E-8));
        a = DoubleFixedMatrix.createInstance(11, 7, new double[]{0.9164172108368044, 0.3370480814672847, 0.9177428436548145, 0.58387448206642, 0.48775465220172454, 0.9032096649877799, 0.9603710030312358, 0.9001887118543878, 0.338193226780238, 0.3059689212519512, 0.6325699851838295, 0.9547764629595911, 0.002606862931757603, 0.8878610795464207, 0.6869754045256988, 0.2581352105785968, 0.9976590635303851, 0.5053935139950506, 0.3801360964144743, 0.4980250347658014, 0.4286043958876392, 0.7215404870331209, 0.18390100107821306, 0.19175164616753193, 0.5427472734030602, 0.6583844107617997, 0.56206452363585, 0.023179808790297463, 0.08754481730636132, 0.6062385295699936, 0.4801808794144915, 0.06170653821101757, 0.1742609512439579, 0.593468194068669, 0.15838120853742, 0.38959766963840325, 0.9559708850230051, 0.5981448885964555, 0.18294559958757506, 0.14244582563287966, 0.4339030321146068, 0.5019584349196405, 0.9846241864856274, 0.38078742404513466, 0.40119981800121307, 0.9193335728954655, 0.05188388929641663, 0.5324152790027398, 0.2825627262016436, 0.23557621075813617, 0.602290668740977, 0.34062634912608203, 0.032660411523040334, 0.5916778621195935, 0.054071150954239866, 0.6003973167454373, 0.8524174691588307, 0.5758492587772043, 0.35378406651708716, 0.5426742264131772, 0.32888967797042734, 0.36760647314460104, 0.1644541946256547, 0.5303203034313356, 0.124673279168801, 0.9470999589792202, 0.867578544863832, 0.8849687649706725, 0.41557406123545215, 0.8341358695696437, 0.0028860726422273997, 0.6644857378886478, 0.5972800446748223, 0.8837047095855246, 0.3788324647477692, 0.18267793261881626, 0.6239912220878241});
        atest = DoubleFixedMatrix.createInstance(7, 11, new double[]{-0.036876455782758444, 0.3475912562904, 0.43894610959937963, -0.1860755487000017, -0.38116602957514517, 0.13543233792398432, 0.30111483752649953, 0.05255907645793065, 0.4406063035970342, -0.27961389613323145, -0.6738785596213899, -0.4135540929645434, 0.027601650044474485, -0.12739493104090693, 0.009962339386794028, 0.25178410204264623, 0.484839196554488, 0.035498057026428685, 0.3158295839144402, 0.3464067413176586, -0.3430059783156768, 0.27768807578812826, -0.5670626968740479, -0.3484220720571844, 1.4259017247212198, -0.4849101810755089, -0.10792347877064493, 0.12782088540138714, -0.2967958804563265, 0.010307193111147625, 0.2642151212135116, 0.4307072359667559, -0.1892317843388214, -0.20961924075379906, -0.08333288425538062, -0.29697425256325855, 0.14507189756281003, -0.14969485970940935, -0.26900110193365756, 0.48260077495564935, -0.399463070492824, -0.0033241674138980715, 0.1957507617446258, 0.7991999086404676, -0.3911130702972632, 0.18542505958525746, -0.0179674707649706, 0.8121537395262378, 0.3057338363381967, -0.2629414019756309, -0.6298774617138118, 0.33223348024747035, 0.05561114640165022, 0.35496513828083076, -0.06940218009655592, 0.9582762447438331, -0.4036943038141247, -0.8605141360875186, 0.7319741374479842, 0.6851743248220605, -0.13361806857604325, 0.020479514426598955, -0.22060627136408284, -0.45746347312405955, -0.07164573715675174, 0.016326470324072834, 1.033778046278926, 0.398303618475368, -0.7712195799580978, -0.5725568509286095, -0.19989458195213416, 0.09675269440244658, 0.16601448634802823, 0.09337685040002576, -0.58864933979397, -0.12678754425222816, 0.128296693057789});
        assertThat(pseudoInverse(a, PseudoInverseMethodType.GREVILLE_METHOD), equalsEps(atest, 1.0E-8));
        a = DoubleFixedMatrix.createInstance(8, 5, new double[]{0.10519057218406724, 0.2442366942630958, 0.02351289814330726, 0.6822814785960004, 0.36968508991330984, 0.2709121216445509, 0.12276506920199204, 0.576346555126291, 0.10117207700841746, 0.21665328750597868, 0.9525890746485207, 0.6733271218759784, 0.6281312525677131, 0.5480709003035994, 0.10600901135497154, 0.050887011780205604, 0.47551538169816576, 0.12251948930707135, 0.619740739057643, 0.19317373705216456, 0.6305822150457117, 0.31987764920492145, 0.46710575099882146, 0.42154538817743525, 0.07947369274329674, 0.42550050698362296, 0.31087827470811935, 0.6158276968598498, 0.8633771971779074, 0.545555288438832, 0.7195616308498399, 0.8648425594482657, 0.41116458287811697, 0.9357145872840562, 0.3698973479247769, 0.08853770683862816, 0.595164463706273, 0.2616544782189584, 0.22797502729588748, 0.3437106730942747});
        atest = DoubleFixedMatrix.createInstance(5, 8, new double[]{0.9864860030403414, -0.6956996804735736, 0.648427151803715, -2.692998664207352, 0.08313934889379215, -0.11565744781064058, 0.8411487344240327, -0.049851795365120743, -0.5618782045929251, -0.049325832061848374, 0.20355950395916403, 0.8525846505183601, -0.2293328032708545, -0.8134980887351507, 0.3181866768940178, 1.0952996928203145, -1.3901969986723883, 1.4008968232800696, -0.058382091846231346, 2.045872031875645, 0.45720898502250495, 0.48233422387105307, -1.0446814680870946, -0.26663322842376025, -0.04550214155018828, -0.19730425847965222, -0.18052805495680047, 1.860941595166493, 0.40316113886329397, 0.40967087187193635, -0.2480934975373513, -1.2933815717276425, 1.7493558707788142, -0.11268232372157538, -0.3914428466753502, -3.5714810694820334, -0.8811496471185799, 0.6060234141752363, 0.7694276002790912, 1.6406669354624932});
        assertThat(pseudoInverse(a, PseudoInverseMethodType.GREVILLE_METHOD), equalsEps(atest, 1.0E-8));
        a = DoubleFixedMatrix.createInstance(5, 11, new double[]{0.9861440571994611, 0.31403767803195914, 0.9516531094911731, 0.6040493695522489, 0.9548940903030753, 0.9915552892328869, 0.3043520099897954, 0.5082855022037416, 0.8603725711877591, 0.12410947586826149, 0.27821263785550143, 0.5497548247713134, 0.8489837383630324, 0.9683498495558545, 0.844663583157354, 0.5769348274949088, 0.035050043545300724, 0.41379834973119345, 0.6936405913909361, 0.5284423395523141, 0.25596916989897445, 0.26420112679337227, 0.019609375700094023, 0.0734749598315273, 0.6672150882886271, 0.3393290424130828, 0.3619882907462587, 0.3249986163270092, 0.08585845130030145, 0.9785225820367652, 0.16586163104815, 0.40289821738844545, 0.4914019678194901, 0.6777956054659517, 0.33160447274948845, 0.870453999084621, 0.10340045006425425, 0.22054482322113278, 0.3840275423701043, 0.8947138205442398, 0.35875293212701853, 0.4440352433935587, 0.30466013681413906, 0.7029934193292607, 0.1463981133546184, 0.28132284559665544, 0.5156411131972762, 0.04242239542870363, 0.019862440813274262, 0.27264916978718345, 0.5247361273647785, 0.8275064108890553, 0.0293023538755095, 0.8605615409701513, 0.5832724316650272});
        atest = DoubleFixedMatrix.createInstance(11, 5, new double[]{0.37534823070518264, 0.004417831654353506, -0.6777596885809887, -0.011096029035298327, 0.3137040468131281, -0.001476141842840839, 0.6527072010153702, -0.8309911347932704, -0.3994670671538239, 0.5879680007717557, -0.31077444061293874, 0.09028352113958271, 0.6761431831105031, 0.6005616929764531, -0.6975110891692345, -0.02470019181364975, 0.46556531632076875, 0.08954064449547978, -0.29058792034039593, -0.16221392108725177, 0.2874475521255722, 0.01565826869569094, 0.1563421341701641, -0.22718394873842637, -0.14853401977174743, 0.7015429636346947, -0.5621594225066375, -0.2104292148183691, -0.3191983370558462, 0.4852345375928885, -0.2232556696410824, 0.02501254922325149, -0.3083921102221322, 0.613657557983707, 0.062044664001162195, -0.0996571383518538, 0.02231501578519019, 0.6507738558580359, -0.223104064703811, 0.07324452639121459, 0.17390103671897605, 0.017389206992243205, -0.046740505687173646, 0.09409284288657968, -0.18296434112942733, 0.38370666655773894, 0.021160985093410606, -0.8969740951414235, -0.8036761581478048, 1.4585018447440223, -0.3873066143936815, -0.2536068665084793, 0.7396162227395943, 0.7880807570374307, -0.5436102300761338});
        assertThat(pseudoInverse(a, PseudoInverseMethodType.GREVILLE_METHOD), equalsEps(atest, 1.0E-8));
        a = DoubleFixedMatrix.createInstance(6, 5, new double[]{0.7032872879764198, 0.8161175921040057, 0.4596287494525342, 0.2836519760382975, 0.18249736494169755, 0.4506260087761611, 0.376821874292677, 0.2934792175726868, 0.43395787400844865, 0.3899560094987625, 0.8711363285807805, 0.6449934044472946, 0.8530672352932186, 0.7270464118077141, 0.4828489562972561, 0.24945740625503576, 0.4487998107083023, 0.7105975220094757, 0.9010112064090389, 0.36555103767239294, 0.7403702989711731, 0.6470626848024231, 0.2304214968855276, 0.9172322726089165, 0.595686591760101, 0.18874654393053758, 0.21511406756017293, 0.19708812989143942, 0.9896094706591492, 0.7566959994548369});
        atest = DoubleFixedMatrix.createInstance(5, 6, new double[]{-1.84660970558728, -0.5228687140818005, 1.7931637373670202, -0.9690283739402326, 2.0389973042950933, -1.566420417851966, 2.8987855558793845, 0.46078416743798767, -2.143706559530926, 0.5622187755519871, -0.9281344683893812, 0.8903678572070277, 0.07041169770476402, 0.4875777107617908, 1.0257488988603432, 0.43195622554669677, -1.7861184772689755, 0.27461383294874653, -1.5500484046079384, -1.6493394811483983, -0.16929884059087452, 1.442163305556958, 2.5367439187775718, -1.3618325886413176, 1.5311792684463836, 2.414846846272546, -0.008485057849762168, -1.8163098462055922, -3.068762925917948, 3.006427493699973});
        assertThat(pseudoInverse(a, PseudoInverseMethodType.GREVILLE_METHOD), equalsEps(atest, 1.0E-8));
        a = DoubleFixedMatrix.createInstance(7, 6, new double[]{0.48612968615334917, 0.7729001624473372, 0.8433700328045916, 0.10140221907977975, 0.12470282804544608, 0.299975194922087, 0.7852390394414538, 0.6654077517576263, 0.8931825850373967, 0.06491572772110443, 0.7214243783176169, 0.8167260377644622, 0.001365558294348701, 0.8267775822188654, 0.18843752123444302, 0.3792335407895734, 0.004445071873309114, 0.2107389757087449, 0.5251249078611326, 0.4352629835303935, 0.9723706040197946, 0.7582905498047096, 0.35626631094279404, 0.7873776978688495, 0.7115185074693102, 0.3171891208911478, 0.6065463892642581, 0.2431896262019393, 0.7045477839540498, 0.22327455708282062, 0.4346243972367122, 0.5663553755655769, 0.17145059651527306, 0.9095459971415056, 0.5266627286078653, 0.4503606074051024, 0.7459287515827251, 0.8306161412695571, 0.6832855199237282, 0.805511807859676, 0.2810476159513614, 0.2941536167882498});
        atest = DoubleFixedMatrix.createInstance(6, 7, new double[]{-0.26610991243672316, 1.5106546885518881, -2.315093415599627, -1.3988750973376394, -1.999098386953946, 0.1874324253533587, 2.710469645594838, 0.37924932328202177, 0.21729941856729101, 0.9947391023871537, -0.6975154543363189, -0.04209113747709736, 0.15059421928977568, -0.034286485359791286, 0.7520670010249707, -1.3340836198098251, 0.737079911670685, 1.3541289011013695, 1.6515943691425363, -0.8998610193486317, -1.0914706004410648, -0.23954479621740027, -0.9446104187686354, 0.10762883932811429, 0.6874538311379507, 0.33308417941682716, 0.36727455171952894, 0.13463306277024145, -0.15879457465126645, -0.7336097241631383, 1.3630947244836664, 0.26656971459928575, 2.5889729993130652, 0.3453616513798682, -1.985169268548666, -0.5791536522840274, 1.7404119916885994, -0.6821080268765543, 0.1218472539564148, -2.191874242591096, 0.456148412664654, 0.28576004503367247});
        assertThat(pseudoInverse(a, PseudoInverseMethodType.GREVILLE_METHOD), equalsEps(atest, 1.0E-8));
        a = DoubleFixedMatrix.createInstance(7, 4, new double[]{0.0028440265845349755, 0.6351739075030413, 0.5000003326671222, 0.09523263869161436, 0.7773987562093245, 0.6187986856429032, 0.9850938668323937, 0.42820754937244043, 0.2879071167283078, 0.03806571514178514, 0.9716297344792686, 0.7384577680992623, 0.5230708808050528, 0.3376431448933327, 0.5274564140088224, 0.1781089886178323, 0.29196081646259353, 0.5880885487654418, 0.49400272747210994, 0.4380077826087624, 0.2566724933140637, 0.6984309496751038, 0.32237301694391185, 0.8898917583320869, 0.9517582007743701, 0.8881326356842618, 0.70093610878366, 0.9703507802051383});
        atest = DoubleFixedMatrix.createInstance(4, 7, new double[]{-0.9438067654503408, 0.45796983706688144, -0.5012869851046701, 0.5346231117441449, -0.3046012084302796, -0.4932215769235189, 0.763708016608889, 0.8711850981736647, 0.012725856174365058, -0.7696281159453081, -0.02535803772125461, 0.37927327762202545, 0.32535625433410004, 0.029662773344208304, 0.5630782064694408, 0.3673814758902648, 0.74556043867907, 0.12180751557698957, 0.11344271785609535, -0.35418680756594745, -0.5335181242726199, -0.5041168935997397, -0.5133140774388432, 0.5645227932825843, -0.40568250058767624, -0.027565750828604508, 0.7451605413341458, 0.28047031819493773});
        assertThat(pseudoInverse(a, PseudoInverseMethodType.GREVILLE_METHOD), equalsEps(atest, 1.0E-8));
        a = DoubleFixedMatrix.createInstance(12, 6, new double[]{0.05719765926649889, 0.5907333583975914, 0.3504989493473917, 0.12507207660705955, 0.4340303190670758, 0.430469558345979, 0.019348311288212683, 0.2436812434740141, 0.9772970930902702, 0.9067932362672672, 0.7536979677994472, 0.2980870977042658, 0.790891549086564, 0.7749371399157092, 0.5762764442617365, 0.12026973557068643, 0.015053516822607471, 0.8020731190485699, 0.22157972482240407, 0.08938256048027293, 0.2716058537385315, 0.9386552662837154, 0.9982473786649091, 0.5772815874692233, 0.8439565900264199, 0.8951685065374969, 0.986182850963652, 0.48224261105773236, 0.242860814642059, 0.12270367122490466, 0.8736771682626585, 0.6490123050588263, 0.7738092099246298, 0.7420189209791348, 0.13470730844624623, 0.28594386394126825, 0.9490037920220317, 0.8959735877879809, 0.6148136561100119, 0.01301355498908785, 0.18874040742125153, 0.3362396446932424, 0.7828151004929811, 0.48155269293695513, 0.9611810754319067, 0.1670538007933683, 0.2764083245376071, 0.40379352012294845, 0.18016313378095672, 0.7251885603118872, 0.14290666125808515, 0.0756187433699067, 0.13451277181467203, 0.17612702173264516, 0.49111191854868763, 0.8013402818381048, 0.34344299691266833, 0.2783876200206642, 0.645199738272661, 0.9486339586314413, 0.03778083102783414, 0.23247467199867233, 0.5637755830331432, 0.7356436132249845, 0.9434617068312404, 0.3297815332620857, 0.16354751174656912, 0.05668757022810933, 0.3034676222773265, 0.15619191824743572, 0.5223984606496435, 0.3408329932456319});
        atest = DoubleFixedMatrix.createInstance(6, 12, new double[]{-0.6158528950547957, -0.8049173632385958, -0.2604834751751517, 0.5819412637145814, 0.14739730389366365, 0.26269844535174947, 0.662297952957411, 0.25178596769927253, -0.357120167656481, -0.07185469185208088, -0.0335607857890898, 0.30099988442793957, 0.4594584573954136, 0.006238168814557077, -0.1519808701654765, -0.2439296223139364, 0.3227070358134041, 0.02198755800063043, 0.11472676163810278, -0.540137455469857, 0.818811828159496, 0.16458398295241672, 0.06958983687250533, -0.37137560809671855, 0.22268529529158926, 0.7480562703993755, 0.24131721692740338, -0.6525352476936952, 0.04971708006123596, -0.2524120582622769, -0.24731803447211187, 0.6316415013916734, -0.29313547378697835, -0.2547561489192129, 0.013134512206024643, 0.13920557759009297, -0.22756515395183366, 0.246177079733035, 0.22807071041994073, 0.42750556516179733, 0.044200949384043675, 0.8307185519630803, -0.48595143268812657, -0.6088182342869597, 0.14423055296561024, -0.05531628922239628, -0.08831504148681452, -0.5359681567760096, 0.0404153471790048, -0.4544373270669589, -0.8552691318174027, 0.3655892407878367, 0.161865848040903, -0.5896593187999212, 0.7113833053713856, 0.20405880305820245, 0.038630356012782564, 0.04930453198018203, 0.5102001741684361, 0.581896158732899, 0.12416861036462129, 0.29132356672196014, 1.0057008492416613, -0.021167567005386828, -0.617501692031154, 0.03956452910597491, -0.5956523814854686, 0.11000502334960088, -0.30472405575859923, 0.4748769790465209, -0.3099594879634564, -0.026384848232570313});
        assertThat(pseudoInverse(a, PseudoInverseMethodType.GREVILLE_METHOD), equalsEps(atest, 1.0E-8));
        a = DoubleFixedMatrix.createInstance(6, 4, new double[]{0.30719632530193064, 0.3739532746048754, 0.1795459948432916, 0.6524678094472458, 0.020737470123970536, 0.34970746775214134, 0.11328868491043309, 0.5689932689120423, 0.13937492888246827, 0.17948980110871737, 0.7746504933421119, 0.9355105797039455, 0.5144551902864202, 0.4385792727959036, 0.9475493120882947, 0.7234098438919182, 0.829912666269347, 0.9849924936740393, 0.13409892480104524, 0.307001294974409, 0.10979760013289852, 0.4370273115246277, 0.3776319997879567, 0.8467908078088038});
        atest = DoubleFixedMatrix.createInstance(4, 6, new double[]{3.545242199554036, -2.0696564995062263, 0.5449274254481703, -0.14387304506309795, 0.192054553279309, -1.8897264485373237, -3.2635564037112816, 1.8499421369992908, -0.8752468859254106, 0.3384884729841123, 0.8834322110057933, 1.6290716155881664, -2.2659397742127254, 0.32517646942647604, 0.03579316778114899, 1.248725592028661, -0.005436543925066428, 0.42309539557509235, 2.2079584105791916, -0.27978044862395657, 0.570258163561282, -0.7109562237131658, -0.43946361399911293, -0.1956593171596489});
        assertThat(pseudoInverse(a, PseudoInverseMethodType.GREVILLE_METHOD), equalsEps(atest, 1.0E-8));
        a = DoubleFixedMatrix.createInstance(6, 9, new double[]{0.5680490686190388, 0.29340968705446624, 0.04002902858992807, 0.20384250544205684, 0.49744906505681374, 0.5271142047568451, 0.7210497089649666, 0.40097718314654474, 0.7301336385321093, 0.7657528987252802, 0.11256150823200517, 0.8201969632620445, 0.6562906893127471, 0.3640385621467761, 0.10373479375024186, 0.015489484823996369, 0.10233896692358091, 0.7994810374580418, 0.8318497921498581, 0.8494198325472568, 0.9793042988755081, 0.18249899199793262, 0.5492941369587971, 0.48092051301914274, 0.5448461276387238, 0.3956409486104646, 0.9370690417890272, 0.018910102812224716, 0.31446434197817097, 0.7783505584069416, 0.5715761564736057, 0.3493746545398938, 0.2331462507627603, 0.5293023261602003, 0.15633473452661284, 0.4111883087335686, 0.32539656874095424, 0.11188699417856796, 0.8660564806751319, 0.24025073808070874, 0.2787112106075914, 0.5393229462444789, 0.9335125478605418, 0.703798111398204, 0.8631447355880132, 0.998087215411485, 0.744006448794276, 0.5930741374160542, 0.8741634616685058, 0.31900559339766, 0.06148476321419616, 0.47536681545549253, 0.3233436066528096, 0.5869025682051754});
        atest = DoubleFixedMatrix.createInstance(9, 6, new double[]{-0.04599594939732432, 0.26122137731969364, 0.05082724486555108, -1.1006451512847568, 0.18927291680604702, 0.543459347552221, -0.20188759097761919, -0.8646138746827502, 0.8401949180364449, 0.3138437169637302, -0.5864459936566231, 0.40199055802474953, -1.0043541939820193, 0.16319077690830813, 0.4515752867954601, 0.18777450595971035, 0.41863403594537885, -0.1784663376806417, 0.27029361720600936, 0.2624672116556378, -0.9274261758146792, 0.757067480546641, -0.2185272411703389, 0.5375541081605687, 0.9485620375537547, 0.3377702312520674, 0.20121201575543815, 0.8942371543009463, -0.9764878258017015, -0.7236904255039927, 0.5627517568706241, 0.05689718254557641, 0.19242078477938956, 0.2863369241027075, -0.21897648272790393, -0.5523430634185279, 0.23017222521279973, -0.6547121407802314, -0.3567420895422956, 0.2853559484719662, 0.4161391817794401, 0.37830266333548823, -0.43995175682370874, -0.3647076182385132, -0.20919636602568675, -0.7960815553356708, 1.0036554098708284, 0.5580094629414967, 0.4278928758626047, 0.6376501404222792, 0.04816974269749724, -0.15205199611913295, -0.012300661246438832, -0.5128775200792409});
        assertThat(pseudoInverse(a, PseudoInverseMethodType.GREVILLE_METHOD), equalsEps(atest, 1.0E-8));
    }

    @Test
    public void testInverseGaussian() {
        DoubleMatrix a, atest;
        a = DoubleFixedMatrix.createInstance(9, 9, new double[]{0.42463323811078457, 0.15137631346391323, 0.8091529632338659, 0.4705646937997995, 0.6544851420097814, 0.5437509456874694, 0.5279629915567852, 0.24415408034136288, 0.5193624805227547, 0.4154081189541925, 0.00790456882089241, 0.15657056596504526, 0.738317613316599, 0.8852668829440321, 0.2053275118138118, 0.4523242961448053, 0.4596623947139118, 0.7379382036381312, 0.16233517903214612, 0.20016952545216982, 0.7511155116689898, 0.8148707141497745, 0.2856570563861255, 0.07452409852325614, 0.260283515808737, 0.43405762326941166, 0.18146555899536732, 0.8529927920514453, 0.3308369311337801, 0.8200753578560174, 0.7297400101345104, 0.05921257381134892, 0.05424480748261806, 0.8135835348453678, 0.6297518788721075, 0.7124795252111527, 0.7196123802919581, 0.8175002777796949, 0.6623223984570257, 0.23615272053397174, 0.7706841783785476, 0.3960147885749248, 0.9347801831335922, 0.0821508431013811, 0.746703779616483, 0.06202351701381903, 0.7458517050276049, 0.10073118539913484, 0.4822810723887757, 0.5765487103990695, 0.32329697466897656, 0.3279628938306508, 0.5356223250438298, 0.580783269416742, 0.07063953412069779, 0.8417475655004057, 0.6177302913539622, 0.5073094153602702, 0.727041445552767, 0.011042382237832826, 0.7945446365763834, 0.3693019765358706, 0.07935605776700161, 0.6243913454082434, 0.019735991974072054, 0.34020966593519286, 0.2565566846954769, 0.21688189427593418, 0.7585524031468163, 0.5903442181875015, 0.637478144788733, 0.8372007447806168, 0.07899425110758118, 0.7806645852225904, 0.4277474044657167, 0.26205376096694444, 0.5668045937592432, 0.40119471553149166, 0.05643829524632016, 0.08028883523715791, 0.8896436374083115});
        atest = DoubleFixedMatrix.createInstance(9, 9, new double[]{36.362018877656894, -6.585709747366426, -27.628447952521316, 18.20036689265684, -12.678555039151751, 25.743829989884123, -8.527887414941267, -22.246324036598146, -9.174550764316347, 5.528394473266108, -1.8337948006013987, -3.9251390708467704, 2.8126798109960682, -1.271334891713594, 5.442272683959303, -1.8744834889151831, -4.009433704851315, -1.703750167666136, 16.427731387079128, -2.9085911948657266, -13.03645790093981, 8.433374023023905, -7.698630867699503, 8.749083858042262, -1.3821016515662978, -8.959765204857081, -1.967585004440908, -37.41379485350216, 6.275853334971742, 31.770998635384476, -19.269211810117735, 16.852532000444366, -22.703121674680986, 4.180839462118558, 20.9058154539507, 6.2174455834147215, 28.892599403374756, -4.083260103560143, -23.135235628223086, 13.944187063618083, -11.893822944048162, 18.36610050024833, -4.209257493485583, -16.89088706903374, -5.664859055349693, -16.915992281044016, 1.9852298462331248, 15.450664615418766, -10.094621945275609, 8.625232824640394, -9.731956469889944, 1.2507682540979794, 10.55975243027342, 2.2264843474989497, -41.87895684488812, 7.404967489419687, 32.159728743618466, -20.76337072119395, 16.707877659269855, -28.4305258818344, 8.424617708247323, 25.092179889091625, 8.547182013015298, 41.70690282816832, -7.045811526477751, -34.21154350988004, 21.588998887670826, -18.880398868439897, 27.2212897930789, -5.537843023906383, -23.57259597585762, -8.061967404737675, -16.844473991302195, 3.616129218788056, 11.626570555137445, -7.4260014325250046, 5.310908346909059, -12.546303938939003, 3.9181569699200547, 10.178452247966668, 5.338801219848774});
        assertThat(inverse(a, InverseMethodType.GAUSSIAN_ELIMINATION), equalsEps(atest, 1.0E-8));
        a = DoubleFixedMatrix.createInstance(5, 5, new double[]{0.7763548631837092, 0.7668203266461815, 0.09380595935090186, 0.32585980577120155, 0.13406587989817642, 0.7471015849470636, 0.6756529218750931, 0.48091125484474406, 0.5555946024429753, 0.48049280190462984, 0.35249537517033436, 0.09562041754614814, 0.21047783585626323, 0.4558830641451772, 0.8054809327058315, 0.5496230258483789, 0.4494682819501421, 0.6169511646252157, 0.6808934398354263, 0.12301794319072112, 0.7603707002719721, 0.4923996386280367, 0.9723404102127255, 0.8987513063979952, 0.1770346147804609});
        atest = DoubleFixedMatrix.createInstance(5, 5, new double[]{3.752221928264805, -3.740150033303396, 1.4519680186603983, -7.785539875949436, 6.113486812964604, -2.318554380830941, 4.45271957146442, -2.0004681399600788, 5.266651198941208, -4.887260752237317, -2.198350113494445, 3.469128949762494, -1.634009621614564, -3.225950235716618, 1.925304892348906, 0.7092778361456937, -3.453108749743624, 1.5589175618527893, 7.2901710971353335, -3.3236228129161223, -1.1938004715108628, 2.156045733716766, 0.3882305201015801, -0.501200071355068, -0.7172169390756499});
        assertThat(inverse(a, InverseMethodType.GAUSSIAN_ELIMINATION), equalsEps(atest, 1.0E-8));
        a = DoubleFixedMatrix.createInstance(7, 7, new double[]{0.2431151804278172, 0.9014174384261371, 0.13258493949616035, 0.1013946693676504, 0.5598980615654077, 0.9781521465097899, 0.48310152988580857, 0.7364322145042599, 0.28394218914356173, 0.7018708266855631, 0.17149386995340166, 0.7760252855069822, 0.1979817885913029, 0.6494146310194897, 0.014797635228221528, 0.6186595916848632, 0.09152486170438534, 0.1867202763448681, 0.07328627870842752, 0.7015263578699884, 0.18891617481875722, 0.3108358601315797, 0.8805781537073144, 0.308252630141049, 0.6262314317740174, 0.6118620853690218, 0.10068214611695625, 0.3739482493504671, 0.9232602670218777, 0.8772336119453421, 0.8547752217197829, 0.6353150771514604, 0.31991676558569593, 0.08263736327825788, 0.39152197791859455, 0.8761732413895132, 0.03345563234058424, 0.7361835454029059, 0.030637970772445677, 0.41060422509434935, 0.09363500863744034, 0.8692054565232166, 0.0408866430353535, 0.1281718955513641, 0.6421601606375335, 0.14995642883539706, 0.16168886201349564, 0.6295913330045502, 0.8278057530756472});
        atest = DoubleFixedMatrix.createInstance(7, 7, new double[]{-3.5427321369364955, 1.5199197821502144, 6.731762232061831, 0.42557362502586005, -1.7294162540702458, 2.530149842988128, -2.692123943958813, 6.592624061265054, -3.982197419333115, -10.12582431947442, -1.0149525470876477, 3.5535056117993435, -1.8008848312812935, 2.256236553740555, 3.839095725169954, -0.4631389401225876, -7.401892674251972, -2.2440525611639, 3.3922709997100293, -3.462767822020532, 2.8573140355475215, -9.035745746192937, 3.9616096032155115, 13.98920010780337, 2.868792522963809, -4.3960819749680375, 2.699386544187122, -3.078342417887278, -0.2926500540084582, 2.1614038024341253, 0.23584645804311088, 0.29163443522933363, -0.778229175972399, -1.0097055247084183, -0.28212365347187895, -4.063055909607849, 2.9229702408030116, 7.855682756693875, 0.04359687232525933, -2.1504957015132704, 0.8643562749656599, -1.624845539617529, 0.9602472264756525, -2.4621110955867342, -1.577624319535126, 1.26712472037124, -0.5123733612410177, 1.8909044492164766, 0.6236423342448918});
        assertThat(inverse(a, InverseMethodType.GAUSSIAN_ELIMINATION), equalsEps(atest, 1.0E-8));
        a = DoubleFixedMatrix.createInstance(3, 3, new double[]{0.3275921478370566, 0.8438780336548833, 0.23520994034580933, 0.5984642668213189, 0.2442426220635634, 0.6127677477175756, 0.3246267677790968, 0.18038582246017, 0.9933783552812814});
        atest = DoubleFixedMatrix.createInstance(3, 3, new double[]{-0.4654241074807823, 2.8042332635349685, -1.6195957118065152, 1.3938357233318919, -0.8775939884286938, 0.21131653739701572, -0.10100791821784794, -0.757036493751903, 1.497561936724102});
        assertThat(inverse(a, InverseMethodType.GAUSSIAN_ELIMINATION), equalsEps(atest, 1.0E-8));
        a = DoubleFixedMatrix.createInstance(8, 8, new double[]{0.3230301417267212, 0.6750595169676709, 0.8309926252640365, 0.16037683554213256, 0.04250603464405833, 0.14056480358139756, 0.8328160334824701, 0.2578632284973763, 0.04593491989449994, 0.9861362066418358, 0.2826713806199821, 0.6694632307341075, 0.5736251730701144, 0.7096814302602599, 0.19460021756821289, 0.17192103254919144, 0.019344325587635436, 0.5988554297676285, 0.37802531503383985, 0.4753952211340937, 0.8313364768391405, 0.804780527583559, 0.7365630840020873, 0.24891313291746342, 0.8513082461060999, 0.8620640268349473, 0.5246496582214698, 0.008898195587172197, 0.8803148165642133, 0.38614582189543123, 0.767143269669505, 0.3958067952636317, 0.8543527681611499, 0.16915482048851094, 0.23685577484758424, 0.4315628697322469, 0.5624328300635139, 0.24733388741713702, 0.7658168072318602, 0.4734263062356675, 0.6404326531755093, 0.8580265826588691, 0.7343562867469344, 0.7647256006728661, 0.5700768903761082, 0.7062076356065047, 0.8316904708524663, 0.8477781553405045, 0.4543085051127955, 0.46332150812606976, 0.12152644451102101, 0.612384036003678, 0.4148659746534229, 0.8654256311970256, 0.6650981317059056, 0.726261156872958, 0.25161641124768463, 0.3501715985717583, 0.08274505982457736, 0.9888774329811758, 0.3635747645801576, 0.9092525552089765, 0.1575164078099761, 0.08656029650041508});
        atest = DoubleFixedMatrix.createInstance(8, 8, new double[]{0.10907877183361658, -0.5534692047882384, -1.0520010618002458, 1.0889666241263634, -0.049584413541487515, -0.25872264889739016, 0.07084274591111325, 1.0307927325719284, 0.6593311130923218, 2.08876421312723, -0.8927397045372932, -0.10581986244789521, 0.4878617998210981, -1.210937815978729, 0.8361116707002978, -0.8851206233351229, -0.3292818089457428, -2.205034140057628, 0.6247168118873031, 0.7364228653404685, -1.7188711733616522, 2.4595096146363353, -1.8759989005843882, 1.2491346026526708, 0.10953600337335112, 1.2794647111241488, -0.1529618146353855, -1.42269127554971, 1.6519635252338831, 0.0721755295102251, -0.656433331555766, -0.15661821423499767, -1.2396714788292922, -0.032589424931264044, 1.0359305026001497, 0.1395266850881703, 0.4122106755504894, 0.89958057689338, -1.2575751349998257, -0.3729421923810803, -0.008361332324462123, -1.9647042910329555, 0.2566009347137227, 1.3598670839392688, -2.202108919602645, 0.055945086283695655, 0.817601629106209, 1.6073080357098406, 1.3074284153724087, 0.8419284414434176, 0.46316921378166603, -0.9085742459339241, 1.4806810449342709, -1.960722345826762, 1.0921699336273194, -0.8027738510339306, -1.0053324670725958, -0.10742246218731755, -0.06964991220616273, -0.40538761494693076, -0.3529128728356173, 1.677013712342599, 0.410529091331192, -1.1241906924789546});
        assertThat(inverse(a, InverseMethodType.GAUSSIAN_ELIMINATION), equalsEps(atest, 1.0E-8));
        a = DoubleFixedMatrix.createInstance(10, 10, new double[]{0.4504097131380095, 0.44492821121079196, 0.682649722309499, 0.5090328180036682, 0.3731385128629675, 0.42858387695512135, 0.5396709521867682, 0.17459885746360915, 0.36344144860163485, 0.9095932776559357, 0.08028385491100187, 0.4684532073091674, 0.7225852685899565, 0.8619316619495009, 0.05252040332978125, 0.06851701665956589, 0.6393075306863973, 0.4673444322505438, 0.9397153346677879, 0.9264545856320046, 0.685720097897703, 0.893590989258197, 0.0701364198315193, 0.39338487030696434, 0.4956189314576953, 0.5827021964807727, 0.8457999449227497, 0.8000090056903435, 0.23815676172475408, 0.697841983653948, 0.2690320478287952, 0.8979390442925863, 0.6965177190411276, 0.9710275980248981, 0.5577026254079678, 0.967456837196939, 0.3541843907889026, 0.7892537461297131, 0.5559407432308373, 0.3269629597379925, 0.5591986607547803, 0.08166383002205202, 0.46572152323741667, 0.7096770033298042, 0.619602836320861, 0.010980397208166903, 0.1320717202802314, 0.9392229939796987, 0.8529303203368495, 0.8221419351412892, 0.31731463974099705, 0.8151563788749507, 0.27975585458647767, 0.3847596722399669, 0.18699110794850227, 0.3579060653589753, 0.4211784223093451, 0.9810790032791956, 0.2766579437261447, 0.7796176300841252, 0.6607058735186412, 0.36367513361126635, 0.6920260482674826, 0.06342196012150603, 0.21210992238933157, 0.04834172362246425, 0.6963933889763643, 0.34128020845860785, 0.1853202981206049, 0.18383601750976863, 0.044770093840507896, 0.7147646183820279, 0.6492494108317932, 0.2519391126562963, 0.3888981103534539, 0.8221462812542476, 0.2011652876347435, 0.32248365442325333, 0.7286665646753165, 0.8041006425889994, 0.9631205316701198, 0.4890163778001513, 0.6379561522930152, 0.8992446746104743, 0.8934119467181457, 0.9293457608087694, 0.710809808913749, 0.31581102115706294, 0.03392344901916233, 0.005596664541762553, 0.11387862663562587, 0.13892142545529151, 0.6022181179256235, 0.25164590163461065, 0.2449594479593301, 0.7030888849814974, 0.46945789890384504, 0.606532950942424, 0.4399934267372516, 0.4855133941218531});
        atest = DoubleFixedMatrix.createInstance(10, 10, new double[]{-23.110552142703668, 12.396847225364851, -13.705353752885776, -27.790515189639788, -2.6193035920835364, 24.242305536616684, -5.691507199861762, 17.0946822819345, 25.318162871226388, -2.885194264345029, 2.410204546876599, -1.4221307532322, 1.6703578188733106, 3.5932565989990546, 0.013530988556369083, -2.4265199189840465, 1.154749043587481, -1.3392238565859058, -3.029545319442407, -0.9332367865548996, 5.6341157649165305, -3.0737977883406966, 1.7335425259265267, 6.310948594253611, 0.5317381799235963, -4.677743187409353, 2.1426505255661965, -3.7578362410302466, -5.515955521123325, 0.6552548285365782, -2.4574963780391483, 2.1130997389660453, -1.989006209832574, -2.9866057166990188, -0.45061799913787737, 3.2011756579041806, -1.487027562207154, 1.2813587295567395, 3.4541778060189365, -0.5342228053615073, 27.208345343718946, -15.340603852996214, 16.5318242636478, 32.2634778510929, 4.042663360710319, -29.058370689613373, 7.118643136998258, -19.488562950097258, -29.279744986199354, 2.543757686337257, -12.411252530348063, 6.567999920549599, -7.210822426470175, -14.760234385488609, -1.880602680907999, 12.810296214342824, -3.810115271362684, 9.294214707997405, 13.622284360550296, -0.4695949419440254, 9.381177056212751, -4.608721073452983, 6.72852836099988, 11.239781198990663, 0.7924825862096856, -10.901688654620877, 2.6819569290564607, -7.526789305209046, -10.494153343184996, 1.713396761507291, 1.9366202679156521, -1.5909918445522355, 1.1993732827198116, 3.0305114395766073, 0.574106015461571, -1.724462670215707, 0.7572389968676551, -2.2391331184918353, -2.7597043518593756, 0.8933996151983438, -10.831790194626048, 5.8607702131042725, -4.856644835471023, -11.357698814064056, -0.8015196020706361, 8.627026158136701, -2.194117992178867, 7.9237703778376725, 10.105183768714054, -1.1658205276011995, 1.5878417639208213, -0.4222343739277904, 0.11564474316479484, -0.05420736216168581, 0.11108024337643607, 0.13843521371092066, -0.5073081554697114, -0.3617269161269262, -0.537320671171399, 0.14787670471132314});
        assertThat(inverse(a, InverseMethodType.GAUSSIAN_ELIMINATION), equalsEps(atest, 1.0E-8));
        a = DoubleFixedMatrix.createInstance(9, 9, new double[]{0.024458516727873802, 0.24697466381231237, 0.039923705780681606, 0.9182608846291427, 0.7794995899559026, 0.3504883335748036, 0.8230530161640917, 0.4138775630460034, 0.5341605378253901, 0.4486109011865501, 0.6735593611786902, 0.23436522799182602, 0.18491157949572257, 0.19676027627696702, 0.0541103066674955, 0.978892512628898, 0.37813151148828317, 0.26510426008929455, 0.6567677260712997, 0.4017104755854637, 0.7928138502504146, 0.08891389377426373, 0.40267072793519865, 0.12226672768262292, 0.2551624036216342, 0.26632617310627715, 0.4972300206750807, 0.825967221551051, 0.5248863105603749, 0.7113648062959108, 0.13788526218022956, 0.8888561207749227, 0.22390249285955677, 0.38754301740596686, 0.8865895538422605, 0.18435667079108453, 0.5094130219867309, 0.8143294912135616, 0.93879347961668, 0.5470105585902809, 0.35701109926421526, 0.5429147916505936, 0.032155256499450835, 0.9907848074421725, 0.7626041113822655, 0.2166433830071991, 0.06247823302540623, 0.6868968229277542, 0.05742937825969041, 0.4520735460671458, 0.8660408474582062, 0.22496541106780132, 0.7685898986648019, 0.48292770981648137, 0.8543224814493997, 0.3528179961409992, 0.08882440801336222, 0.5044222383052511, 0.12223214393919057, 0.2790415545969497, 0.2992464906607697, 0.12644955696138316, 0.4174519694264406, 0.8774982714880585, 0.20692450879942537, 0.8927817424346778, 0.6929436729835065, 0.5030247382261076, 0.11929870050368874, 0.7769440327687794, 0.7283227485680972, 0.5112609282213578, 0.5284643044707651, 0.12185460456204944, 0.7977804521560289, 0.8951894090665333, 0.43185739948380975, 0.555435200341215, 0.07496499083866959, 0.12356501303378908, 0.43979198894515736});
        atest = DoubleFixedMatrix.createInstance(9, 9, new double[]{-0.4013335727609013, -0.29600533335486434, -0.059770761518002924, 0.36192881865398197, -0.34785584282697135, 0.035558438863475754, 1.0898293306163989, 0.23741916311277075, -0.1645908670498159, -0.0922694131429414, 0.9530529586118635, -0.014136847590622836, 0.34597429091649423, 0.5879607463458169, -0.5748557041228677, -0.1972470704592393, -1.099761410691136, 0.4859423675754544, -0.5251734498275888, 0.5086983770839533, 0.3271005033204403, -0.1844407884390786, -0.018177212804235676, -0.043011503339813593, -1.1000209933497664, 0.2532013266938139, 0.8672622139850957, 0.10815343543842543, -0.012478653547647323, -0.9958271991004319, -0.011729039965500704, 0.36238487823659377, -0.5962344891461837, -0.08044605784258105, 0.3554810521650751, 0.696409009543068, 0.8063796224699833, -0.6061294634864568, 0.8458135381635594, 0.8466466526951406, -0.4465737469994618, -0.18125407618805522, -0.1759710028664204, -0.6489780630245853, -0.03035378432060376, -0.33586466309265994, 0.6840539139519447, -0.6807983199125317, 0.09351750581020102, -0.3376046330045673, 0.9944365265061003, 0.3642804745245215, -0.8235946630639104, 0.8311945998270324, -0.004158939278237184, 0.936066299090628, -0.07266773279173983, -0.31759167762141843, -0.5340930432171017, 0.3610076535256788, -0.2695661213116697, 0.30770537784355123, 0.08395610561894037, -0.07470365181287722, -0.43791060751727595, -1.0730113557496794, 0.2380326859953612, 0.632290503583266, 0.16073200993885034, 0.06477951822765529, 0.8492344994827593, -0.8535530181557599, 0.894381468204446, -1.1110079636593542, 1.8524931401106821, -1.1345360021318258, 0.3287121304468231, 0.22356264375278898, 0.6447434179699062, 0.22291933897456156, -1.4482470247230852});
        assertThat(inverse(a, InverseMethodType.GAUSSIAN_ELIMINATION), equalsEps(atest, 1.0E-8));
        a = DoubleFixedMatrix.createInstance(9, 9, new double[]{0.3640954549024228, 0.9634093600506534, 0.0822446411016573, 0.7656914798542925, 0.8283639262564926, 0.04942668725076993, 0.39343969705277093, 0.8438949262300155, 0.2573055709891031, 0.023286942598773064, 0.5654105824885669, 0.19069157676134907, 0.6284999440476094, 0.4499393004474401, 0.035392947285330045, 0.40268053322645125, 0.5993112068699062, 0.13483814321699572, 0.9181258273380168, 0.41954893995678677, 0.6318304258985689, 0.5337336132743471, 0.9052615666596243, 0.15026765038619783, 0.2924569836319575, 0.7116507676682376, 0.5450425185863929, 0.0024272996073951836, 0.9974108392592973, 0.7299951823015548, 0.27163819964147484, 0.5696677852940876, 0.3538505558210787, 0.7100012231161061, 0.6544419407513902, 0.07737415541424542, 0.39065205604722475, 0.6231751785571221, 0.2446456391997508, 0.07590122600105398, 0.8163892710475663, 0.8767019661571767, 0.481750212150148, 0.8605965205332547, 0.7185947828340068, 0.07866840337349257, 0.3109396324680457, 0.10577120165154619, 0.6100610859178939, 0.8817139255397756, 0.7846562256436824, 0.6127655268446205, 0.6973643699323924, 0.8010575446101071, 0.26574529765065025, 0.9000817800534928, 0.8100056288915333, 0.9851146845748925, 0.10510762380786198, 0.5811826861280522, 0.09633170122314672, 0.9409266573779552, 0.794611015985063, 0.3806434288510677, 0.24742949644496282, 0.12014368052812685, 0.2399519634147721, 0.4064366618265356, 0.8904933906315262, 0.6549722664270062, 0.27702965916899647, 0.36043786694818614, 0.7294691871968142, 0.9821674452013455, 0.5558770677587052, 0.3810312716108526, 0.25897538603534287, 0.792033735730094, 0.1057767088206526, 0.37323394937343135, 0.0044875459668942685});
        atest = DoubleFixedMatrix.createInstance(9, 9, new double[]{0.5767389654852791, -0.235330716332685, 0.5719111684701597, -0.5166580203742726, 0.15031109604632603, -1.3322915749227489, 0.14758457080817863, 1.2617757839947434, -0.2765804119092491, 3.061683819845831, -4.646710057949615, -0.6801746647816512, 1.3198477648182991, -0.9659250889891264, 0.07220571400375486, 0.7039074361409052, 0.5181206307121382, -0.5454297860301304, -1.4183901079448906, 0.4457165924337559, 0.6794209760108391, 0.7111157883315558, -0.36161770985594255, 0.5350462674732597, -0.006674238434427923, -0.7925358975917631, 0.3881626233905113, -0.25938427263273955, 0.988514111115792, 0.04301699851925185, -0.4895655836523931, -1.0677285654723703, 0.8627321288278043, 0.05278279455709159, -0.05628747785029088, 0.5342977532401415, -0.21839843553071234, -0.4493367295186075, 0.3543952859918027, 0.3550919802965496, -0.43793191043408264, 2.004056439770141, -0.9916610603404066, -1.6944804413003558, 0.9399785191695996, -1.728928263946012, 2.1714086893934006, -0.3503285003724326, -0.7289200715029798, 0.6209820055416082, 0.7295101814042149, -0.5161617416733539, -0.6299928540497928, 1.3425341596717657, 0.9900064056372229, -0.8477362438808345, 0.043459204535537165, 0.7503824453397885, -0.4682087330039989, -1.2814521422819576, 0.3780487595239537, 2.350258220933175, -1.4994418098616236, -3.3052673501716487, 7.032148363559824, 0.1025118819074015, -1.9501322417788103, 3.009487733498357, -1.8426523039870184, -0.5257460437118998, -0.7591660213946059, 0.4774326036092157, 3.1937883531852425, -6.0906581015926955, -0.08402705251767406, 1.2642130461814713, -1.16693992730772, 0.28744056207559426, 1.438566380842731, 1.1677476723972036, -1.8375895723615132});
        assertThat(inverse(a, InverseMethodType.GAUSSIAN_ELIMINATION), equalsEps(atest, 1.0E-8));
        a = DoubleFixedMatrix.createInstance(10, 10, new double[]{0.16217832073846727, 0.561187966925162, 0.23439059067067336, 0.22313750290399104, 0.7844315492990791, 0.21912363842994964, 0.11614708200172119, 0.8942010422642812, 0.8699386693528802, 0.5387959759869364, 0.5086860869942712, 0.6101441646289371, 0.8605438663874253, 0.2504196985877144, 0.4280329942417531, 0.6297876097888242, 0.8209610939769137, 0.506632226470349, 0.14609387980492217, 0.2244815611033626, 0.509726825910723, 0.5552676095005099, 0.14552554167698328, 0.7807395728202668, 0.33826220740451785, 0.27684012619688647, 0.5502424948980107, 0.3132810543700302, 0.13490780178109174, 0.40950485745995324, 0.9620749839852193, 0.7053952897120219, 0.7487376553695316, 0.6271230998916665, 0.7491500835002022, 0.6859332210698262, 0.8400420932851546, 0.3074743289529913, 0.06999634907768526, 0.8384312622792163, 0.6303122311221742, 0.2236592405511375, 0.2267400378853034, 0.5541622867965516, 0.33128320879696915, 0.40610486040226246, 0.28010530167331626, 0.6944045038990744, 0.36412221930444333, 0.7060076459269958, 0.44504594384370466, 0.09191749948508743, 0.31304341232079025, 0.44124401775495614, 0.46168234662336394, 0.687408072829927, 0.3676922678941791, 0.7323158642200958, 0.4362968870205989, 0.04235197047538397, 0.583112391799662, 0.981732116771209, 0.6114809302870898, 0.010799291440046765, 0.8988973014435003, 0.33414714222216935, 0.9791073107788701, 0.9005671319145298, 0.7582211074647611, 0.2731684726221246, 0.3486415641947842, 0.7217165740893693, 0.334812261345631, 0.28071887848224886, 0.26535302285417917, 0.2922614045599037, 0.48906714487865843, 0.23210103966126305, 0.9380650328157226, 0.05883041594031446, 0.8619832879007846, 0.873495330588467, 0.5211552878017633, 0.8764599831377208, 0.7093606938220355, 0.3685507089487289, 0.6571490466307861, 0.5903334397271623, 0.5125287777767871, 0.7874020545318114, 0.1282355677817696, 0.8999476817442745, 0.3872109833388875, 0.6074513460189319, 0.8975426581356817, 0.04222071007736372, 0.6021512027826911, 0.6055280469251755, 0.9233464826252402, 0.14320521100230188});
        atest = DoubleFixedMatrix.createInstance(10, 10, new double[]{-1.0198515761410611, -1.2020337225641111, -1.618124980958619, -0.8359352444685471, -1.446215252401934, 1.337069015169587, 1.0043354853687072, -0.17324420776077937, 3.92282726694046, -1.4368253620705498, 2.1814923296401227, 0.7942835281462818, 1.9508868752165047, -1.332576680855174, -3.576295754803796, 0.03872907258681657, -0.01809385929865725, 0.25123787791396246, 2.3334406323617065, -2.508615478386723, -0.8261382406302187, 1.5296756078645104, -2.655520971670214, -0.5746224922261731, 0.5691921987131782, -0.26363757906179747, -0.8689057432659717, -0.37324842355216764, 1.7782022877971384, 0.9736628671544933, -0.48062106423831663, 0.3183231215432606, 0.17408540880237391, -0.39995245141890934, 0.2665837443685195, 0.24931823955105747, -0.8839462503727459, -0.23702460664822786, 0.48500959980068153, 0.8818569438689569, 0.14338965510957902, -1.3308835894120847, -0.6685324702264678, 1.304985105555601, -1.2254499003199513, 0.9458051200061753, 0.2806532692046518, -0.7743304926835615, 0.14076512424901397, 0.5886527557261455, 1.9342516574232507, 0.2469518258443632, 2.0429533181977138, 0.9537206210398677, -1.4539029027473378, 0.6595628657401942, -0.6317551107125374, 0.928642958324498, -1.8001514709092874, -1.3959880264700626, -1.7338872524884636, -0.2932177009375203, 0.8595084094481655, 1.4017125637348768, 3.606289525645362, -1.2613965935012912, 0.7585933899802697, 0.29988448270696116, -4.521653435957482, 2.2043099424107617, 0.3550276298652396, 0.8769139408730655, 0.4311788456647426, -1.6932347195108994, 0.06202780718327716, 0.18204495423452347, 0.44048708661684177, -0.8326651279442969, 1.0410862170982105, -0.612016982015053, -0.7120362389019439, -0.5773206829673927, -1.0342332680261204, 0.6007049059584989, 1.7557281511486402, -0.2620950286783275, -0.15023054552634546, 1.0991237727267011, -1.235563699318579, 1.0748097722193437, 0.3880546452367185, 0.11443433111306442, 0.44967455707846077, 1.3054734633261142, 2.462501110781612, -1.683627687150282, -0.3430692975973906, 0.3433033576869704, -2.8166094000238444, 0.7724512562438591});
        assertThat(inverse(a, InverseMethodType.GAUSSIAN_ELIMINATION), equalsEps(atest, 1.0E-8));
        a = DoubleFixedMatrix.createInstance(9, 9, new double[]{0.35997995389465964, 0.011162143288278248, 0.657399146076012, 0.8318212994419152, 0.1996135213602528, 0.5783725040742989, 0.4621175931875432, 0.8754190597500667, 0.38828082089606375, 0.8159182800327306, 0.5261253404895897, 0.4533876537695689, 0.3937795783013168, 0.27480905103521003, 0.2822923422388176, 0.5374647168213127, 0.8473953979774395, 0.5157650678052143, 0.6033481967242598, 0.16100905545224276, 0.8683992380063864, 0.8172904057719665, 0.05469585389032172, 0.11520489674316581, 0.648059393754619, 0.7067974755118758, 0.8944512430839446, 0.4188169105599039, 0.3015114355881985, 0.17745581742932748, 0.11279098857983882, 0.6589654815074911, 0.029974059684327092, 0.7300154895419242, 0.8187054517311819, 0.9008798574331791, 0.012181500863333916, 0.14797663406799044, 0.010485541460701242, 0.45534786874374666, 0.5985341553643034, 0.41126859392673965, 0.48379217247433626, 0.7035940657482985, 0.4177436891129892, 0.20061037443233098, 0.4458829020837338, 0.12013107265313794, 0.22695704652850301, 0.4932401255990321, 0.3356915098491108, 0.7730567863655917, 0.25282949139337385, 0.6784736691088298, 0.975621465780958, 0.39435990839409973, 0.6406018294217258, 0.8096941502418914, 0.27645689000321594, 0.39467462890645266, 0.6111204390285407, 0.47902267271579446, 0.31533983090368845, 0.8584631204554547, 0.9920722112392051, 0.4959160373618243, 0.031905324690476244, 0.1332638501964648, 0.9474428148348674, 0.09219083281240614, 0.7196899960275037, 0.17462394082814103, 0.98569667142571, 0.6376906910483499, 0.975911405192273, 0.7271305780742717, 0.9371218419529087, 0.7301225907776927, 0.7268971930510464, 0.9604575209684999, 0.11817486829903645});
        atest = DoubleFixedMatrix.createInstance(9, 9, new double[]{0.6311694929861755, -1.6717873211348773, -1.184822795736924, 2.1889417023824214, -0.9316585947481308, -1.0473612525792537, 2.5700924685827955, 0.5077513227361174, -0.7983533772598839, -2.938389882188356, 2.7055981397377273, 1.9270036401927946, -3.0687445899522876, 2.1757138636851026, 0.5829003717203196, -1.8682004289960314, -0.09760934649394792, 0.7464908780059258, 0.1589588821290832, -0.6280351451086439, 1.057199066102307, -0.12457238314352914, -1.1419357851702538, 0.29245525253422067, -1.3854124855963126, 0.04547735254772854, 1.1538597134530642, -2.0829762927486297, 0.05297997152000988, 1.5679657477484206, -1.6210045374277215, 2.827804433280029, -0.8139402681420917, 0.7315618802087238, -0.041861896526739384, -0.11106401633624247, -1.5722465586930934, -3.153553913962145, 0.7780242401921289, 1.4769445302145656, 1.436349609692213, -1.390985341628408, 1.1551794588674942, 0.6669449515251158, 0.6219097156912552, 2.0726279025504972, -2.373932428081147, -1.3143190935690174, 1.4227702195924932, -1.0420932296822816, 0.4086754059573958, 1.2329451024091211, 0.9602909410066376, -0.7188926968356024, 2.7522800836374426, 4.1131256082824565, -2.344388242922178, -1.2554456979711395, -2.9406356728915846, 3.0728117992920163, -1.635102215206059, -1.8971038925104364, 0.24019788484275573, 0.7007017408555676, 2.7066090987582774, -0.47083349215589765, -0.6528224745415598, 0.035278114373095804, -0.1470870866481091, -1.5498124622826848, -0.5803729294403548, 0.13819233715816465, -0.866483817813394, -3.418263367603644, 1.303580812298065, 1.829876683394676, 0.9107121288430435, -1.0163495392858635, 1.4591641827077795, 1.3378244578532887, -0.8432862966437353});
        assertThat(inverse(a, InverseMethodType.GAUSSIAN_ELIMINATION), equalsEps(atest, 1.0E-8));
    }
}
